#1 고양이와 개는 몇 마리 있을까

SELECT ANIMAL_TYPE, COUNT(*)
FROM ANIMAL_INS
WHERE ANIMAL_TYPE = 'Cat' OR
      ANIMAL_TYPE = 'Dog'
GROUP BY ANIMAL_TYPE
ORDER BY ANIMAL_TYPE;

#2 동명 동물 수 찾기

-- 기본 코드
SELECT NAME, COUNT(NAME)
FROM ANIMAL_INS
GROUP BY NAME
HAVING COUNT(NAME) > 1
ORDER BY NAME;

-- 서브 쿼리 활용 코드
SELECT T.NAME, T.NUM
FROM(
    SELECT NAME, COUNT(NAME) AS NUM
    FROM ANIMAL_INS
    GROUP BY NAME) T
WHERE NUM > 1
GROUP BY NAME
ORDER BY NAME ASC;

#3 입양 시각 구하기(1)

-- WHERE 절 사용
SELECT HOUR(DATETIME), COUNT(HOUR(DATETIME))
FROM ANIMAL_OUTS
WHERE HOUR(DATETIME) >= 9 AND
        HOUR(DATETIME) < 20
GROUP BY HOUR(DATETIME)
ORDER BY HOUR(DATETIME);

--HAVING 절 사용*
SELECT HOUR(DATETIME) HOUR, COUNT(HOUR(DATETIME))
FROM ANIMAL_OUTS
GROUP BY HOUR(DATETIME)
HAVING HOUR >= 9 AND
        HOUR < 20
ORDER BY HOUR(DATETIME);

#4 입양 시각 구하기(2)

SET @HOUR_LIST = -1;
SELECT
(@HOUR_LIST := @HOUR_LIST + 1) AS 'HOUR',
(SELECT COUNT(*)
FROM ANIMAL_OUTS
WHERE HOUR(DATETIME) = @HOUR_LIST) AS 'COUNT'
FROM ANIMAL_OUTS
WHERE @HOUR_LIST < 23;



